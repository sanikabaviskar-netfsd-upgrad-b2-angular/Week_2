<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mini Expense Tracker</title>
</head>
<body onload="initDB()">

    <h1>Mini Expense Tracker</h1>

    Title:<br>
    <input type="text" id="title"><br><br>

    Amount:<br>
    <input type="number" id="amount"><br><br>

    Date:<br>
    <input type="date" id="date"><br><br>

    <button onclick="addExpense()">Add Expense</button>
    <button onclick="viewExpenses()">View Expenses</button>

    <h3>Expense List:</h3>
    <ul id="expenseList"></ul>

    <script>

        var db;

        function initDB() {
            if (window.openDatabase) {
                db = openDatabase("ExpenseDB", "1.0", "Expense Database", 2 * 1024 * 1024);

                db.transaction(function(tx) {
                    tx.executeSql(
                        "CREATE TABLE IF NOT EXISTS expenses (id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT, amount REAL, date TEXT)",
                        [],
                        function() { console.log("Table ready"); },
                        function(tx, error) { alert("Table creation error: " + error.message); }
                    );
                }, function(error) {
                    alert("Transaction error: " + error.message);
                });

            } else {
                alert("Web SQL not supported in this browser.");
            }
        }

        function addExpense() {
            var title = document.getElementById("title").value;
            var amount = document.getElementById("amount").value;
            var date = document.getElementById("date").value;

            db.transaction(function(tx) {
                tx.executeSql(
                    "INSERT INTO expenses (title, amount, date) VALUES (?, ?, ?)",
                    [title, amount, date],
                    function() {
                        alert("Expense Added");
                        viewExpenses();
                    },
                    function(tx, error) {
                        alert("Insert error: " + error.message);
                    }
                );
            }, function(error) {
                alert("Transaction error: " + error.message);
            });
        }

        function viewExpenses() {
            db.transaction(function(tx) {
                tx.executeSql(
                    "SELECT * FROM expenses",
                    [],
                    function(tx, results) {
                        var list = document.getElementById("expenseList");
                        list.innerHTML = "";

                        for (var i = 0; i < results.rows.length; i++) {
                            var item = results.rows.item(i);

                            var li = document.createElement("li");
                            li.innerHTML =
                                item.title + " - â‚¹" + item.amount + " - " + item.date +
                                " <button onclick='deleteExpense(" + item.id + ")'>Delete</button>";

                            list.appendChild(li);
                        }
                    },
                    function(tx, error) {
                        alert("Select error: " + error.message);
                    }
                );
            });
        }

        function deleteExpense(id) {
            db.transaction(function(tx) {
                tx.executeSql(
                    "DELETE FROM expenses WHERE id=?",
                    [id],
                    function() {
                        alert("Expense Deleted");
                        viewExpenses();
                    },
                    function(tx, error) {
                        alert("Delete error: " + error.message);
                    }
                );
            }, function(error) {
                alert("Transaction error: " + error.message);
            });
        }

    </script>

</body>
</html>
